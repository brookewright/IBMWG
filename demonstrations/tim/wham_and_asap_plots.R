#devtools::install_github("timjmiller/wham", dependencies=TRUE)
#source("demonstrations/tim/wham_and_asap.R")
wham_stuff = readRDS("demonstrations/tim/wham_res.RDS")
asap_fit = dget("demonstrations/tim/WHAM2ASAP_TEST_NOSR_1.RDAT")
wham_sim = wham_stuff[[1]][[1]]
wham_fit = wham_stuff[[2]][[1]]


cairo_pdf("demonstrations/tim/wham_asap_SSB_compare.pdf", family = "Times", height = 10, width = 10)
par(oma = c(0,0,0,0), mar = c(5,5,1,1))
plot(1970:2019, wham_sim$SSB, type ='n', axes =FALSE, lwd = 2, xlab = "Year", ylab = "SSB", cex.lab = 2)
grid(col = gray(0.7))
legend("topright", col = c(gray(0.7), "blue", "red"), lty = 2, lwd =2, legend = c("True", "WHAM", "ASAP"), cex = 1.5)
lines(1970:2019, wham_sim$SSB, lwd = 2, lty = 2, col = gray(0.7))
lines(1970:2019, wham_fit$SSB, lwd = 2, lty = 2, col = "blue")
lines(1970:2019, asap_fit$SSB, lwd = 2, lty = 2, col = "red")
axis(1, lwd = 2, cex.axis = 1.5)
axis(2, lwd = 2, cex.axis = 1.5)
box(lwd = 2)
dev.off()

cairo_pdf("demonstrations/tim/wham_asap_F_compare.pdf", family = "Times", height = 10, width = 10)
par(oma = c(0,0,0,0), mar = c(5,5,1,1))
plot(1970:2019, wham_sim$F, type ='n', axes =FALSE, lwd = 2, xlab = "Year", ylab = "F", cex.lab = 2, ylim = c(0,1))
grid(col = gray(0.7))
legend("topright", col = c(gray(0.7), "blue", "red"), lty = 2, lwd =2, legend = c("True", "WHAM", "ASAP"), cex = 1.5)
lines(1970:2019, wham_sim$F, lwd = 2, lty = 2, col = gray(0.7))
lines(1970:2019, wham_fit$F, lwd = 2, lty = 2, col = "blue")
lines(1970:2019, asap_fit$F.age[,10], lwd = 2, lty = 2, col = "red")
axis(1, lwd = 2, cex.axis = 1.5)
axis(2, lwd = 2, cex.axis = 1.5)
box(lwd = 2)
dev.off()

cairo_pdf("demonstrations/tim/wham_asap_R_compare.pdf", family = "Times", height = 10, width = 10)
par(oma = c(0,0,0,0), mar = c(5,5,1,1))
plot(1970:2019, wham_sim$NAA[,1], type ='n', axes =FALSE, lwd = 2, xlab = "Year", ylab = "Recruit", cex.lab = 2)
grid(col = gray(0.7))
legend("topright", col = c(gray(0.7), "blue", "red"), lty = 2, lwd =2, legend = c("True", "WHAM", "ASAP"), cex = 1.5)
lines(1970:2019, wham_sim$NAA[,1], lwd = 2, lty = 2, col = gray(0.7))
lines(1970:2019, wham_fit$NAA[,1], lwd = 2, lty = 2, col = "blue")
lines(1970:2019, asap_fit$N.age[,1], lwd = 2, lty = 2, col = "red")
axis(1, lwd = 2, cex.axis = 1.5)
axis(2, lwd = 2, cex.axis = 1.5)
box(lwd = 2)
dev.off()

png("demonstrations/tim/wham_asap_compare.png", family = "Times", units = "in", type = "cairo-png", height = 10, width = 6, res = 500)

par(oma = c(0,0,0,0), mar = c(5,5,1,1),mfrow = c(3,1))

plot(1970:2019, wham_sim$SSB, type ='n', axes =FALSE, lwd = 2, xlab = "", ylab = "SSB", cex.lab = 2)
grid(col = gray(0.7))
legend("topright", col = c(gray(0.7), "blue", "red"), lty = 2, lwd =2, legend = c("True", "WHAM", "ASAP"), cex = 1.5)
lines(1970:2019, wham_sim$SSB, lwd = 2, lty = 2, col = gray(0.7))
lines(1970:2019, wham_fit$SSB, lwd = 2, lty = 2, col = "blue")
lines(1970:2019, asap_fit$SSB, lwd = 2, lty = 2, col = "red")
axis(1, lwd = 2, cex.axis = 1.5)
axis(2, lwd = 2, cex.axis = 1.5)
box(lwd = 2)

plot(1970:2019, wham_sim$F, type ='n', axes =FALSE, lwd = 2, xlab = "", ylab = "F", cex.lab = 2, ylim = c(0,1))
grid(col = gray(0.7))
legend("topright", col = c(gray(0.7), "blue", "red"), lty = 2, lwd =2, legend = c("True", "WHAM", "ASAP"), cex = 1.5)
lines(1970:2019, wham_sim$F, lwd = 2, lty = 2, col = gray(0.7))
lines(1970:2019, wham_fit$F, lwd = 2, lty = 2, col = "blue")
lines(1970:2019, asap_fit$F.age[,10], lwd = 2, lty = 2, col = "red")
axis(1, lwd = 2, cex.axis = 1.5)
axis(2, lwd = 2, cex.axis = 1.5)
box(lwd = 2)

plot(1970:2019, wham_sim$NAA[,1], type ='n', axes =FALSE, lwd = 2, xlab = "Year", ylab = "Recruit", cex.lab = 2)
grid(col = gray(0.7))
legend("topright", col = c(gray(0.7), "blue", "red"), lty = 2, lwd =2, legend = c("True", "WHAM", "ASAP"), cex = 1.5)
lines(1970:2019, wham_sim$NAA[,1], lwd = 2, lty = 2, col = gray(0.7))
lines(1970:2019, wham_fit$NAA[,1], lwd = 2, lty = 2, col = "blue")
lines(1970:2019, asap_fit$N.age[,1], lwd = 2, lty = 2, col = "red")
axis(1, lwd = 2, cex.axis = 1.5)
axis(2, lwd = 2, cex.axis = 1.5)
box(lwd = 2)
dev.off()
